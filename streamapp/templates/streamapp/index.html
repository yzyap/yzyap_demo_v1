{% extends 'streamapp/base.html' %}
{% load static %}

{% block content %}
<div id = "containerWindow" class="grid-container">
  <div id="tabButton" class="grid-item tab_container">
    <button class="tablinks" onclick="openCity(event, 'London')">Blok</button>
    <button class="tablinks" onclick="openCity(event, 'blocklyDiv')">Kod</button>
    <button class="tablinks" onclick="openCity(event, 'Tokyo')">Yapay Zeka</button>
  </div>  
  <div id = "codeWindow" class="grid-item code_container">
    {% include "streamapp/blockly.html" %}
  </div>
  <div id = "videoWindow" class="grid-item video_container">2</div>
  <div id = "settingsWindow" class="grid-item settings_container">3</div>  
</div>
{% endblock %}


{% block javascript %}
<script src="{% static "/js/blockly_compressed.js" %}"></script>
<script src="{% static "/js/blocks_compressed.js" %}"></script>
<script src="{% static "/js/python_compressed.js" %}"></script>
<script src="{% static "/js/en.js" %}"></script>
<script src="{% static "/js/robot.js" %}"></script>  

<script>

/*var c = document.getElementById('canvas');
var ctx = c.getContext('2d');
var imageObj = null;
var rect = {};
var drag = false;   */

var demoWorkspace = Blockly.inject('blocklyDiv',
        {media: '{% static "/media/" %}',
         toolbox: document.getElementById('toolbox')}); 

function init(){
  console.log('init fired..') ;

  c.addEventListener("mousedown", function(e) 
    { 
      mouseDown(c, e); 
    }); 

  c.addEventListener('mouseup', mouseUp, false);
  c.addEventListener('mousemove', function(e) 
    { 
      mouseMove(c, e); 
    });           
}

function mouseDown(canvas, event) {
  let canvasrect = canvas.getBoundingClientRect();
  rect.startX = event.clientX - canvasrect.left;
  rect.startY = event.clientY - canvasrect.top;
  drag = true;
}  

function mouseUp() { 
  drag = false; 
}

function mouseMove(canvas, event) {
    if (drag) {
        let canvasrect = canvas.getBoundingClientRect();  
        ctx.clearRect(0, 0, 640, 480);
        rect.w = (event.clientX  - canvasrect.left) - rect.startX;
        rect.h = (event.clientY - canvasrect.top) - rect.startY;
        ctx.strokeStyle = 'red';
        ctx.strokeRect(rect.startX, rect.startY, rect.w, rect.h);
    }
}

init();

sideWindowHeight = 0;

/*function fBodyOnload()
{
  console.log("body onload!");
  hpage = $(document).height();
  wpage = $(document).width();

  hnavbar = document.getElementById("pageheader").offsetHeight;
  wnavbar = document.getElementById("pageheader").offsetWidth;
  wcontainer = wpage -10;
  hcontainer = hpage-hnavbar;  

  containerWindow = document.getElementById("containerWindow");
  containerWindow.style.width = wpage + "px";
  containerWindow.style.height = hpage-hnavbar+ "px";

  sideWindowHeight = hcontainer/2;

  //containerWindow.style.gridTemplateRows = sideWindowHeight + "px " + sideWindowHeight + "px";
}*/

function fBodyResize()
{
  console.log("body resize!");

  hpage = $(window).height();
  wpage = $(window).width();  

  hnavbar = document.getElementById("pageheader").offsetHeight;
  wnavbar = document.getElementById("pageheader").offsetWidth;
  wcontainer = wpage -10;
  hcontainer = hpage-hnavbar;

  containerWindow = document.getElementById("containerWindow");
  containerWindow.style.width = wcontainer + "px";
  containerWindow.style.height = hcontainer + "px";  

  //containerWindow.style.gridTemplateRows = sideWindowHeight + "px " + sideWindowHeight + "px;"
}


</script>
{% endblock %}

{% block stylesheet %}
<style>
.grid-container {
  display: grid;
  grid-column-gap: 10px;
  grid-template-columns: 1fr minmax(480px,1fr) minmax(640px, 1fr);
  grid-template-rows: 50px minmax(480px,1fr) minmax(240px,1fr);
  /*background-color: #2196F3;*/
  padding: 10px;
}

.grid-item {
  background-color: rgba(200, 200, 200, 0.8);
  border: 1px solid rgba(0, 0, 0, 0.8);
  padding: 10px;
  font-size: 15px;
  text-align: left;
}

.code_container{
  grid-column: 1/3;
  grid-row: 2/4;
}

.video_container{
  grid-column: 3/4;
  grid-row: 1/3;
}

.tab_container{
  grid-column: 1/3;
  grid-row: 1/2;
}

.settings_container{
  grid-column: 3/4;
  grid-row: 3/4;
}

.navbar {
  margin-bottom: 10px;
}
</style>
{% endblock %}


